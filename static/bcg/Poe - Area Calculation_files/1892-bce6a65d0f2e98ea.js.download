(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1892],{81132:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatPageNavActionBar_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"isSystemBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsFollower",storageKey:null},{args:null,kind:"FragmentSpread",name:"BotFollowStateButton_bot"},{args:null,kind:"FragmentSpread",name:"BotShareButton_bot"},{args:null,kind:"FragmentSpread",name:"botHelpers_useDeletion_bot"}],type:"Bot",abstractKey:null};t.hash="4b22e87f2b7eff2725617b32292bafb5",a.default=t},89915:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatPageNavbar_bot",selections:[{args:null,kind:"FragmentSpread",name:"ChatPageNavActionBar_bot"},{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null}],type:"Bot",abstractKey:null};t.hash="63d9207f5c71d252b2f63e7e4092eaa9",a.default=t},36035:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[{defaultValue:5,kind:"LocalArgument",name:"count"},{defaultValue:null,kind:"LocalArgument",name:"cursor"}],kind:"Fragment",metadata:{connection:[{count:"count",cursor:"cursor",direction:"backward",path:["messagesConnection"]}]},name:"ChatPageNavbar_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null},{alias:"messagesConnection",args:null,concreteType:"MessagesConnection",kind:"LinkedField",name:"__ChatMessagesView_chat_messagesConnection_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"messageHelpers_isChatBreak",selections:[{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null}],args:null,argumentDefinitions:[]},{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null}],storageKey:null}],type:"Chat",abstractKey:null};t.hash="0827d9deafab4f8b7a3dd470a7917021",a.default=t},92672:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatPageNavbar_viewer",selections:[{alias:"useShareButtonRedesign",args:[{kind:"Literal",name:"gateName",value:"poe_share_button_redesign"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_share_button_redesign")'},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};t.hash="b1adddd46d179ba3e536127bcc2c2a21",a.default=t},57890:function(e,a,n){"use strict";n.d(a,{Z:function(){return chat_ChatMainNavbar}});var t=n(85893),l=n(42116),r=n(67294),s=n(22120),i=n(22578),o=n(3108),u=n.n(o),bot_BotDownBanner=()=>{let{t:e}=(0,s.$G)();return(0,t.jsx)("div",{className:u().botDownBanner,children:e("This bot is currently down.")})},c=n(41019),d=n(3597),g=n(39620),h=n(61918),m=n(69208),f=n(52667),_=n(6890),v=n(19029),b=n(50141),p=n(10406),k=n(57031),C=n.n(k),x=n(8143),B=n(6488),S=n(44254),y=n(46296),F=n(35409),w=n(69295),P=n(96333),N=n.n(P),chat_ChatOfflineBanner=()=>{let{t:e}=(0,s.$G)();return(0,t.jsx)("div",{className:N().offlineBanner,children:e("You are offline.")})},j=n(37650),I=n(13827),M=n.n(I),K=n(83243),Z=n(72211),chat_ChatPageNavActionBar=e=>{let{bot:a}=e,l=(0,i.useFragment)(n(81132),a),{isDeleted:r}=(0,j.iZ)(l);return l.isSystemBot||l.viewerIsFollower||r||l.isPrivateBot?null:(0,t.jsxs)("div",{className:M().container,children:[(0,t.jsx)(K.Z,{bot:l,variant:"flat"}),(0,t.jsx)(Z.Z,{bot:l,variant:"flat"})]})};let importShareBotOrChatModal=()=>n.e(8289).then(n.bind(n,28289));var chat_ChatPageNavbar=e=>{let{bot:a,chat:l,viewer:o,children:u,toggleSidebarButton:k,useChatTitle:P=!1,hideActionBar:N=!1}=e,j=(0,i.useFragment)(n(89915),a),I=(0,i.useFragment)(n(36035),null!=l?l:null),M=(0,i.useFragment)(n(92672),o),K=(0,r.useContext)(m.c),{shouldShowSignupWall:Z,openSignupWall:D}=(0,F.zl)(),O=!K.isEmbed,T=K.isEmbed,E=(0,_.a)(),V=(0,p.Z)(),{t:L}=(0,s.$G)(),[W,A]=(0,r.useState)(!1),{useShareButtonRedesign:R}=M,z=(0,r.useCallback)(()=>{A(!1)},[]),H=(0,r.useMemo)(()=>({botId:j.botId,chatId:null==I?void 0:I.chatId,closeModal:z}),[j,I,z]),U=(0,r.useMemo)(()=>{var e,a;return null==I?void 0:null===(a=I.messagesConnection)||void 0===a?void 0:null===(e=a.edges)||void 0===e?void 0:e.filter(e=>!(0,f.hb)(e.node)).map(e=>{var a;return null==e?void 0:null===(a=e.node)||void 0===a?void 0:a.messageId}).slice(-2)},[I]),{selectionMode:G,setSelectionMode:X,addSelection:$,clearSelection:q}=(0,b.ZP)(),Q=(0,r.useCallback)(()=>{X(b.oW.none),q()},[X,q]),Y=(0,r.useMemo)(()=>G===b.oW.none?k||(0,t.jsx)(y.Z,{}):(0,t.jsx)(w.t9,{className:C().endSelectionButton,onClick:Q,children:(0,t.jsx)(g.Z,{className:C().closeIcon})}),[G,Q,k]),J=(0,r.useCallback)(()=>{R?A(!0):(U&&U.forEach(e=>$(e)),X(b.oW.share)),(0,v.Z)("poe/action_log",{action_type:B.Z.share_button_click,bot_id:j.botId,chat_id:null==I?void 0:I.chatId,action_metadata:{context:x.Z.nav_bar}})},[X,$,U,R,j.botId,null==I?void 0:I.chatId]),ee=(0,r.useCallback)(e=>(0,t.jsx)(w.oM,{disabled:!R&&!(null==U?void 0:U.length),className:e?C().shareButton:C().noTextShareButton,onClick:J,children:(0,t.jsxs)("span",{className:C().shareTextWrapper,children:[(0,t.jsx)(h.Z,{className:C().shareIcon}),e&&(0,t.jsx)("span",{className:C().shareText,children:L("Share")})]})}),[J,L,U,R]),ea=(0,r.useCallback)(()=>{Z&&D(F.dh.navBarSignupButton)},[Z,D]),en=(0,r.useMemo)(()=>(0,t.jsx)(w.DF,{onClick:ea,children:(0,t.jsx)("span",{className:C().signUpText,children:L("Sign up")})}),[ea,L]),et=(0,r.useMemo)(()=>{if(T)return(0,t.jsx)(d.Z,{});let e=!M.poeUser&&E;return(0,t.jsxs)("span",{className:C().rightNavItemWrapper,children:[G===b.oW.none&&!(null==j?void 0:j.isPrivateBot)&&ee(!e),e&&en]})},[T,G,j,ee,M,en,E]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{leftNavItem:O&&Y,rightNavItem:et,useChatTitle:P,children:u}),!N&&(0,t.jsx)(chat_ChatPageNavActionBar,{bot:j}),V&&(0,t.jsx)(chat_ChatOfflineBanner,{}),j.isDown&&(0,t.jsx)(bot_BotDownBanner,{}),(0,t.jsx)(c.Z,{isOpen:W,onRequestClose:z,body:importShareBotOrChatModal,bodyProps:H,variant:"compact"})]})},chat_ChatMainNavbar=e=>(0,t.jsx)(chat_ChatPageNavbar,{toggleSidebarButton:(0,t.jsx)(l.Z,{}),hideActionBar:!0,...e})},16392:function(e,a,n){"use strict";var t=n(85893),l=n(67294),r=n(34616),s=n(13333),i=n.n(s),o=n(30791);let usePagingTriggerRef=e=>{let{loadMore:a,canLoadMore:n,rootMargin:t,scrollRootRef:r}=e,s=l.useRef(null),i=(0,l.useContext)(o.f),u=void 0!==r?r:i;return(0,l.useEffect)(()=>{var e;if(!s.current||!n)return;let l=new IntersectionObserver(e=>{e[0].isIntersecting&&a()},{root:null!==(e=null==u?void 0:u.current)&&void 0!==e?e:null,threshold:0,rootMargin:t});return l.observe(s.current),()=>{l.disconnect()}},[a,n,t,u]),s},calcRootMargin=(e,a,n)=>"".concat(!a&&n?e:0,"px ").concat(a&&!n?e:0,"px ")+"".concat(a||n?0:e,"px ").concat(a&&n?e:0,"px");a.Z=e=>{let{children:a,className:n,loadMore:l,hasMore:s,isLoading:o,loadingState:u=null,error:c,errorState:d=null,threshold:g,horizontal:h=!1,reverse:m=!1,scrollRootRef:f}=e,_=usePagingTriggerRef({loadMore:l,canLoadMore:s&&!o&&!c,rootMargin:calcRootMargin(g,h,m),scrollRootRef:f}),v=c?d:(0,t.jsx)("div",{ref:_,className:i().pagingTrigger,children:o&&u});return(0,t.jsxs)("div",{className:(0,r.$)(i().container,h&&i().horizontal,n),children:[m&&v,a,!m&&v]})}},50141:function(e,a,n){"use strict";n.d(a,{Br:function(){return MultiselectProvider},oW:function(){return l}});var t,l,r=n(85893),s=n(67294);(t=l||(l={}))[t.none=0]="none",t[t.share=1]="share",t[t.delete=2]="delete";let i=(0,s.createContext)(0),o=(0,s.createContext)(()=>{}),u=(0,s.createContext)([]),c=(0,s.createContext)(()=>{}),MultiselectProvider=e=>{let{children:a}=e,[n,t]=(0,s.useState)(0),[l,d]=(0,s.useState)([]);return(0,r.jsx)(i.Provider,{value:n,children:(0,r.jsx)(o.Provider,{value:t,children:(0,r.jsx)(u.Provider,{value:l,children:(0,r.jsx)(c.Provider,{value:d,children:a})})})})};a.ZP=()=>{let e=(0,s.useContext)(i),a=(0,s.useContext)(o),n=(0,s.useContext)(u),t=(0,s.useContext)(c),l=(0,s.useCallback)(e=>{t(a=>[...a,e])},[t]),r=(0,s.useCallback)(e=>{t(a=>a.filter(a=>a!==e))},[t]),d=(0,s.useCallback)(e=>{n.includes(e)?r(e):l(e)},[n,r,l]),g=(0,s.useCallback)(()=>{t([])},[t]),h=(0,s.useMemo)(()=>0!==e,[e]);return{selectionMode:e,selectedIds:n,setSelectionMode:a,addSelection:l,removeSelection:r,toggleSelection:d,clearSelection:g,isSelecting:h}}},10406:function(e,a,n){"use strict";n.d(a,{q:function(){return getHasBeenOffline}});var t=n(67294);let l=!1,getHasBeenOffline=()=>l;a.Z=()=>{let[e,a]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let setOffline=()=>{l=!0,a(!0)},setOnline=()=>{a(!1)};return window.addEventListener("offline",setOffline),window.addEventListener("online",setOnline),()=>{window.removeEventListener("offline",setOffline),window.removeEventListener("online",setOnline)}},[a]),e}},3108:function(e){e.exports={botDownBanner:"BotDownBanner_botDownBanner__gn4_i"}},95427:function(e){e.exports={emptyView:"ChatMessagesView_emptyView__HqDf7",infiniteScroll:"ChatMessagesView_infiniteScroll__vk3VX",messagePair:"ChatMessagesView_messagePair__ZEXUz",loaderWrapper:"ChatMessagesView_loaderWrapper__XPhVQ",errorState:"ChatMessagesView_errorState__xXPE4"}},96333:function(e){e.exports={offlineBanner:"ChatOfflineBanner_offlineBanner__KOexN"}},13827:function(e){e.exports={container:"ChatPageNavActionBar_container__PVN0U"}},13333:function(e){e.exports={container:"InfiniteScroll_container__PHsd4",horizontal:"InfiniteScroll_horizontal__i7SXE",pagingTrigger:"InfiniteScroll_pagingTrigger__cdz9I"}}}]);