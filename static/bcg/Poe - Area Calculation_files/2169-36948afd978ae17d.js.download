(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2169],{8787:function(e,a,n){"use strict";var l,t=n(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}a.Z=function(e){return t.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=t.createElement("path",{d:"M4 13h14.09l-6.79 6.79a.996.996 0 1 0 1.41 1.41l8.5-8.5c.06-.06.09-.13.13-.2.03-.04.06-.08.08-.13a.91.91 0 0 0 .08-.37c0-.03-.01-.05-.01-.07-.01-.1-.02-.21-.06-.31a.955.955 0 0 0-.22-.33L12.72 2.8c-.2-.2-.45-.29-.71-.29-.26 0-.51.1-.71.29a.996.996 0 0 0 0 1.41L18.08 11H4c-.55 0-1 .45-1 1s.45 1 1 1Z"})))}},1656:function(e,a,n){"use strict";var l,t=n(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}a.Z=function(e){return t.createElement("svg",_extends({viewBox:"0 0 15 26",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=t.createElement("path",{d:"M7.11 26C3.287 26 .178 22.757.178 18.772V5.312C.179 2.382 2.469 0 5.285 0 6.66 0 7.947.559 8.913 1.573a5.38 5.38 0 0 1 1.478 3.74v11.439c0 1.872-1.472 3.395-3.282 3.395-1.809 0-3.281-1.523-3.281-3.395V8.333a1 1 0 0 1 2 0v8.418c0 .769.575 1.394 1.281 1.394.707 0 1.282-.625 1.282-1.394V5.31c0-.894-.328-1.732-.926-2.36a2.998 2.998 0 0 0-2.18-.952c-1.713 0-3.106 1.485-3.106 3.312v13.46c0 2.882 2.212 5.228 4.93 5.228 2.72 0 4.932-2.346 4.932-5.228V8.333a1 1 0 0 1 2 0v10.439c0 3.985-3.109 7.228-6.932 7.228Z"})))}},5466:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowsImageAttachments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsFileUpload",storageKey:null},{args:null,kind:"FragmentSpread",name:"ChatMessageInputContainer_useIsBotDisabled_bot"},{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_bot"},{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_bot"},{args:null,kind:"FragmentSpread",name:"botHelpers_useViewerHasNoMessagesLeft_bot"}],type:"Bot",abstractKey:null};l.hash="ec09d7f1875adcc939b8196beaf4bdf4",a.default=l},42785:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageInputContainer_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_messageEdges"}],type:"MessageEdge",abstractKey:null};l.hash="3763d1e0a57ccedfde9ee810abab3e3b",a.default=l},61251:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_useIsBotDisabled_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{args:null,kind:"FragmentSpread",name:"botHelpers_useDeletion_bot"}],type:"Bot",abstractKey:null};l.hash="e53845314ed7af231c18539113680869",a.default=l},50467:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_viewer",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_viewer"}],type:"Viewer",abstractKey:null};l.hash="6347fb46f69ef00f92231811f58623be",a.default=l},46348:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_MessageLimitTooltip_bot",selections:[{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"shouldShowRemainingMessageCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numMessagesRemaining",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageUsageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"baseModelDisplayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null}],type:"Bot",abstractKey:null};l.hash="81aa0eb3ed5b58b038d4e4ada0bc9a57",a.default=l},28217:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_MessageLimitTooltip_viewer",selections:[{alias:"useNewLimitSystem",args:[{kind:"Literal",name:"gateName",value:"poe_use_new_limit_system_frontend"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_new_limit_system_frontend")'}],type:"Viewer",abstractKey:null};l.hash="fe0f805fb7ab2bd85ad08d50e08cfc8b",a.default=l},72612:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_bot",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_MessageLimitTooltip_bot"}],type:"Bot",abstractKey:null};l.hash="eba74d59a2653cb8d880d362c483ed44",a.default=l},19117:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_viewer",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_MessageLimitTooltip_viewer"}],type:"Viewer",abstractKey:null};l.hash="014de188329d066ec7f06974e0310210",a.default=l},9883:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageTextArea_bot",selections:[{args:null,kind:"FragmentSpread",name:"subscriptionHelpers_useBotLogData_bot"},{args:null,kind:"FragmentSpread",name:"botHelpers_useViewerHasNoMessagesLeft_bot"}],type:"Bot",abstractKey:null};l.hash="5e5674f17e6353a7dc2608e86d15a879",a.default=l},87330:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"ChatMessageTextArea_getLastHumanMessageText_messageEdge"};l.hash="a01c79c1084fa7fcca797236c2cf1604",a.default=l},73938:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageTextArea_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_useOnKeyDown_messageEdges"}],type:"MessageEdge",abstractKey:null};l.hash="adef175ef9e8eb0b392205c0b7ec1e41",a.default=l},91963:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageTextArea_useOnKeyDown_messageEdges",selections:[{kind:"InlineDataFragmentSpread",name:"ChatMessageTextArea_getLastHumanMessageText_messageEdge",selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{kind:"InlineDataFragmentSpread",name:"messageHelpers_isHumanMessage",selections:[{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null}],args:null,argumentDefinitions:[]}],storageKey:null}],args:null,argumentDefinitions:[]}],type:"MessageEdge",abstractKey:null};l.hash="326ac8a25d146f97c1aab77fcfc8ef9b",a.default=l},99747:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatSubscriptionPaywallContextWrapper_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"canSend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowSubscriptionRationale",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dailyLimit",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageUsageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"shouldPromptSubscription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowLimitInfoBanner",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"WebSubscriptionAnnouncementModalOpener_bot"},{args:null,kind:"FragmentSpread",name:"WebSpeedUpsellModalOpener_bot"},{args:null,kind:"FragmentSpread",name:"subscriptionHelpers_useBotLogData_bot"}],type:"Bot",abstractKey:null};l.hash="bcc8730ac19995cc0e69307b9e023c3b",a.default=l},35363:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatSubscriptionPaywallContextWrapper_usePaywallAndLog_bot",selections:[{args:null,kind:"FragmentSpread",name:"subscriptionHelpers_useBotLogData_bot"}],type:"Bot",abstractKey:null};l.hash="e86dcb63108845be4baba940f82cfaa4",a.default=l},47252:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatSubscriptionPaywallContextWrapper_viewer",selections:[{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebSubscriptions",storageKey:null},{alias:"useNewLimitSystem",args:[{kind:"Literal",name:"gateName",value:"poe_use_new_limit_system_frontend"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_new_limit_system_frontend")'},{args:null,kind:"FragmentSpread",name:"WebSubscriptionAnnouncementModalOpener_viewer"},{args:null,kind:"FragmentSpread",name:"MwebAndroidSubscriptionAnnouncementModalOpener_viewer"},{args:null,kind:"FragmentSpread",name:"WebSpeedUpsellModalOpener_viewer"},{args:null,kind:"FragmentSpread",name:"WebSubscriptionSuccessMessage_useWebSubscriptionSuccessMessage_viewer"}],type:"Viewer",abstractKey:null};l.hash="44c42a437c47bea73ae3d0dc98a9d0be",a.default=l},95851:function(e,a,n){"use strict";var l,t,s;n.r(a);let i={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"dismissibleType"}],kind:"Fragment",metadata:null,name:"MwebAndroidSubscriptionAnnouncementModalOpener_dismissDismissible_Mutation",selections:[{alias:null,args:t=[{kind:"Variable",name:"dismissibleType",variableName:"dismissibleType"}],concreteType:"DismissDismissible",kind:"LinkedField",name:"dismissDismissible",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"shouldSeeAndroidSubscriptionAnnouncement",storageKey:null}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"MwebAndroidSubscriptionAnnouncementModalOpener_dismissDismissible_Mutation",selections:[{alias:null,args:t,concreteType:"DismissDismissible",kind:"LinkedField",name:"dismissDismissible",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"d783c7564e85e14dac870e5ca01c325a98a237375f2e4f332f2a3b9bcf082833",metadata:{},name:"MwebAndroidSubscriptionAnnouncementModalOpener_dismissDismissible_Mutation",operationKind:"mutation",text:null}};i.hash="8a0b27f1765a46901355248281b1eedb",a.default=i},89116:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MwebAndroidSubscriptionAnnouncementModalOpener_viewer",selections:[{alias:null,args:null,kind:"ScalarField",name:"shouldSeeAndroidSubscriptionAnnouncement",storageKey:null}],type:"Viewer",abstractKey:null};l.hash="773789ae4f752092e075c3efd8b5dd4c",a.default=l},66856:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WebSpeedUpsellModalOpener_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null}],type:"Bot",abstractKey:null};l.hash="7ade3cf445794d7a100c58c2d220fbc4",a.default=l},68222:function(e,a,n){"use strict";var l,t,s;n.r(a);let i={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"dismissibleType"}],kind:"Fragment",metadata:null,name:"WebSpeedUpsellModalOpener_dismissDismissible_Mutation",selections:[{alias:null,args:t=[{kind:"Variable",name:"dismissibleType",variableName:"dismissibleType"}],concreteType:"DismissDismissible",kind:"LinkedField",name:"dismissDismissible",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"shouldSeeResponseSpeedUpsell",storageKey:null}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"WebSpeedUpsellModalOpener_dismissDismissible_Mutation",selections:[{alias:null,args:t,concreteType:"DismissDismissible",kind:"LinkedField",name:"dismissDismissible",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"97465bf0683cf08e943fd041b1d8c29bbd87090b96af6094ddeea6b0ccb20230",metadata:{},name:"WebSpeedUpsellModalOpener_dismissDismissible_Mutation",operationKind:"mutation",text:null}};i.hash="2f0221b1e1202952d33cc565324d9d37",a.default=i},22234:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WebSpeedUpsellModalOpener_viewer",selections:[{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeResponseSpeedUpsell",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement",storageKey:null}],type:"Viewer",abstractKey:null};l.hash="8ff847cd3db3d848f7361368c197c090",a.default=l},60867:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WebSubscriptionAnnouncementModalOpener_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSystemBot",storageKey:null}],type:"Bot",abstractKey:null};l.hash="96e05b9ab8f921f956986a29ebe861f3",a.default=l},60943:function(e,a,n){"use strict";var l,t,s;n.r(a);let i={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"dismissibleType"}],kind:"Fragment",metadata:null,name:"WebSubscriptionAnnouncementModalOpener_dismissDismissible_Mutation",selections:[{alias:null,args:t=[{kind:"Variable",name:"dismissibleType",variableName:"dismissibleType"}],concreteType:"DismissDismissible",kind:"LinkedField",name:"dismissDismissible",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement",storageKey:null}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"WebSubscriptionAnnouncementModalOpener_dismissDismissible_Mutation",selections:[{alias:null,args:t,concreteType:"DismissDismissible",kind:"LinkedField",name:"dismissDismissible",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"4a5844dcd7e79cd6b2c0bcadebbbf593e85a167b1cab854d5527e6be12c8b468",metadata:{},name:"WebSubscriptionAnnouncementModalOpener_dismissDismissible_Mutation",operationKind:"mutation",text:null}};i.hash="5ef690b09af14848d43e2c77b76aeaad",a.default=i},99343:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WebSubscriptionAnnouncementModalOpener_viewer",selections:[{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement",storageKey:null},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};l.hash="2f5b19f143369a7a724a2c3712f4c1b4",a.default=l},23196:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WebSubscriptionSuccessMessage_useWebSubscriptionSuccessMessage_viewer",selections:[{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"willCancelAtPeriodEnd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"purchaseRevocationReason",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};l.hash="4beab1045f7d12cc42b85e5c3dae772d",a.default=l},38117:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"getChatContentType_chat"};l.hash="2291a2b3c3c16aec13efd467f4adefba",a.default=l},16761:function(e,a,n){"use strict";var l,t,s,i;n.r(a);let r={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"messageId"}],kind:"Fragment",metadata:null,name:"localMessageQuery",selections:[{alias:null,args:t=[{kind:"Variable",name:"messageId",variableName:"messageId"}],concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},{kind:"InlineDataFragmentSpread",name:"messagesConnection_message",selections:[i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"ChatMessagesView_useMessagePairs_messages"},{args:null,kind:"FragmentSpread",name:"ChatHistoryListItem_message"}],args:null,argumentDefinitions:[]}],storageKey:null}],type:"QueryRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"localMessageQuery",selections:[{alias:null,args:t,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[s,i,{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sourceType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attachmentTruncationState",storageKey:null},{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},i],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"isInline",storageKey:null}],type:"MessageAttachment",abstractKey:null}],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"vote",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasCitations",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}]},{kind:"TypeDiscriminator",abstractKey:"__isNode"}],storageKey:null}]},params:{id:"bd677c7d64e0f740a827b95545a894d0e05ae2e2ac6395dc81473d4ee5403afc",metadata:{},name:"localMessageQuery",operationKind:"query",text:null}};r.hash="ba8e5951a2189610f1c7b6d89d8f886f",a.default=r},97605:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"messageHelpers_isBotMessage"};l.hash="026b4aa8e0c8f7cabdd643af5bab6d29",a.default=l},45817:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"messageHelpers_isChatBreak"};l.hash="cfc438dc2a212f2623c6474a67a8acaa",a.default=l},45963:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"messageHelpers_isHumanMessage"};l.hash="51b5bb6253d4683e435e030736de3af1",a.default=l},51151:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"messagesConnection_message"};l.hash="cfb93ef751c8784742eb56c3f403e5da",a.default=l},17048:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"resendMessage_chat"};l.hash="18d6b5bb8062a445ad9f0eb2fd4f5f1d",a.default=l},71669:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"resendMessage_message"};l.hash="e56e3fa2233e8ab03a48556a6fc0f1ec",a.default=l},53398:function(e,a,n){"use strict";var l,t,s,i,r,o,u,d,c,g,m,p,b,y,h,k,f,_,S,F,v,C,M,K,w,L,T,x,I,A,D,E,N,R,B,V,O,U,P,j,W,Z,H;n.r(a);let G=(l={defaultValue:null,kind:"LocalArgument",name:"attachments"},t={defaultValue:null,kind:"LocalArgument",name:"bot"},s={defaultValue:null,kind:"LocalArgument",name:"chatId"},i={defaultValue:null,kind:"LocalArgument",name:"clientNonce"},r={defaultValue:null,kind:"LocalArgument",name:"query"},o={defaultValue:null,kind:"LocalArgument",name:"sdid"},u={defaultValue:null,kind:"LocalArgument",name:"shouldFetchChat"},d={defaultValue:null,kind:"LocalArgument",name:"source"},c=[{kind:"Variable",name:"attachments",variableName:"attachments"},{kind:"Variable",name:"bot",variableName:"bot"},{kind:"Variable",name:"chatId",variableName:"chatId"},{kind:"Variable",name:"clientNonce",variableName:"clientNonce"},{kind:"Variable",name:"query",variableName:"query"},{kind:"Variable",name:"sdid",variableName:"sdid"},{kind:"Variable",name:"source",variableName:"source"}],g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},k={alias:null,args:null,concreteType:"MessageCreateFailedUrl",kind:"LinkedField",name:"failedUrls",plural:!0,selections:[h={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reason",storageKey:null}],storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"chatCode",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"hasMarkdownRendering",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"sourceType",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"attachmentTruncationState",storageKey:null},I={alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null},h,g],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"isInline",storageKey:null}],type:"MessageAttachment",abstractKey:null}],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},O={kind:"TypeDiscriminator",abstractKey:"__isNode"},U={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"isDeleted",storageKey:null},W=[{kind:"Literal",name:"last",value:5}],Z={alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null},H=[{kind:"Literal",name:"gateName",value:"poe_message_citation_web"}],{fragment:{argumentDefinitions:[l,t,s,i,r,o,u,d],kind:"Fragment",metadata:null,name:"sendMessageMutation",selections:[{alias:null,args:c,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,p,{kind:"InlineDataFragmentSpread",name:"messagesConnection_message",selections:[g,{args:null,kind:"FragmentSpread",name:"ChatMessagesView_useMessagePairs_messages"},{args:null,kind:"FragmentSpread",name:"ChatHistoryListItem_message"}],args:null,argumentDefinitions:[]},{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_message",selections:[g],args:null,argumentDefinitions:[]}]}],storageKey:null},{args:null,kind:"FragmentSpread",name:"sendMessageMutation_messageEdge"}],storageKey:null},b,y,k,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[g,f,_,S,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[g,F,v],storageKey:null},{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_chat",selections:[g,f,_,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[F],storageKey:null},{kind:"InlineDataFragmentSpread",name:"getChatContentType_chat",selections:[{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[C],storageKey:null}],args:null,argumentDefinitions:[]}],args:null,argumentDefinitions:[]},{args:null,kind:"FragmentSpread",name:"ChatHistoryListItem_chat"},{args:null,kind:"FragmentSpread",name:"ChatPage_chat"}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ChatPage_viewer"}],storageKey:null}]}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[s,t,r,d,i,o,l,u],kind:"Operation",name:"sendMessageMutation",selections:[{alias:null,args:c,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,p,g,M,K,w,L,T,x,I,A={alias:null,args:null,kind:"ScalarField",name:"vote",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},N={alias:null,args:null,kind:"ScalarField",name:"hasCitations",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null},V={kind:"ClientExtension",selections:[B={alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}]},O],storageKey:null},U],storageKey:null},b,y,k,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[g,f,_,S,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[g,F,v,C,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"deletionState",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"image",plural:!1,selections:[P,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"localName",storageKey:null}],type:"LocalBotImage",abstractKey:null},{kind:"InlineFragment",selections:[h],type:"UrlBotImage",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsCreator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSystemBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsFollower",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"followerCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shareLink",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowsImageAttachments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"canSend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowSubscriptionRationale",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dailyLimit",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"numMessagesRemaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowRemainingMessageCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageUsageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"shouldPromptSubscription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowLimitInfoBanner",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canSendMessage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"totalBalance",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isOfficialBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canUserAccessBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsFileUpload",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"baseModelDisplayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowsClearContext",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"conversationStarters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"monthlyActiveUsers",storageKey:null},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"creator",plural:!1,selections:[j,{alias:null,args:[{kind:"Literal",name:"size",value:"small"}],kind:"ScalarField",name:"profilePhotoUrl",storageKey:'profilePhotoUrl(size:"small")'},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:"nullableHandle",args:null,kind:"ScalarField",name:"handle",storageKey:null},g,O],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"poweredBy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"serverBotDependenciesLimitsString",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageTimeoutSecs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isLimitedAccess",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldHideLimitedAccessTag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mayHaveSuggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsResend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasWelcomeTopics",storageKey:null},O],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastInteractionTime",storageKey:null},{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"lastMessage",plural:!1,selections:[M,g],storageKey:null},j,{alias:null,args:W,concreteType:"MessagesConnection",kind:"LinkedField",name:"messagesConnection",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[g,m,M,w,R,K,p,L,T,x,I,A,D,E,N,P,V,O],storageKey:null},U,g],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},g],storageKey:"messagesConnection(last:5)"},{alias:null,args:W,filters:null,handle:"connection",key:"ChatMessagesView_chat_messagesConnection",kind:"LinkedHandle",name:"messagesConnection"},O,{kind:"ClientExtension",selections:[B]}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[Z,g,p],storageKey:null},{alias:"allowImages",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images")'},{alias:"allowImagesForApiBots",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images_for_api_bots"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images_for_api_bots")'},{alias:"enableImageViewer",args:[{kind:"Literal",name:"gateName",value:"poe_web_image_viewer"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_image_viewer")'},{alias:"enableMessageCitation",args:H,kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_message_citation_web")'},{alias:"enableMath",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_markdown_math"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_markdown_math")'},{alias:null,args:null,kind:"ScalarField",name:"promptBotImageDomainWhitelist",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasActiveSubscription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebSubscriptions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleToPurchaseOnAnyPlatform",storageKey:null},{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"expiresTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"willCancelAtPeriodEnd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"purchaseRevocationReason",storageKey:null}],storageKey:null},{alias:"useNewLimitSystem",args:[{kind:"Literal",name:"gateName",value:"poe_use_new_limit_system_frontend"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_new_limit_system_frontend")'},Z,{alias:"enableResendButton",args:[{kind:"Literal",name:"gateName",value:"poe_resend_button_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_resend_button_web")'},{alias:"useBotRecencyOrder",args:[{kind:"Literal",name:"gateName",value:"poe_your_bots_recency_ranking_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_your_bots_recency_ranking_web")'},{alias:"retryButtonEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_message_retry_button"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_message_retry_button")'},{alias:"poeMessageDropdownImageOptions",args:[{kind:"Literal",name:"gateName",value:"poe_message_dropdown_image_options"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_message_dropdown_image_options")'},{alias:"shouldShowCitation",args:H,kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_message_citation_web")'},{alias:"enableImageAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_enable_image_attachments_for_bots"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_image_attachments_for_bots")'},{alias:"showTruncationWarning",args:[{kind:"Literal",name:"gateName",value:"poe_show_truncation_warning"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_truncation_warning")'},{alias:"decoupleBotHandleAndName",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_handle_display_name_decoupling"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_handle_display_name_decoupling")'},{alias:"enableBotMetadata",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_metadata_user_view"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_metadata_user_view")'},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeAndroidSubscriptionAnnouncement",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeResponseSpeedUpsell",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"showConversationStarters",storageKey:null},{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBot",plural:!1,selections:[v,g],storageKey:null},{alias:"useShareButtonRedesign",args:[{kind:"Literal",name:"gateName",value:"poe_share_button_redesign"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_share_button_redesign")'},{alias:"improvePrivacyConfidence",args:[{kind:"Literal",name:"gateName",value:"poe_improve_privacy_confidency"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_improve_privacy_confidency")'},g],storageKey:null}]}],storageKey:null}]},params:{id:"a37c3ecb4948e5de38664ec3e8066ea51d700bb1d3e47cfd8e2f6ad750327dc8",metadata:{},name:"sendMessageMutation",operationKind:"mutation",text:null}});G.hash="e6b71c609cbdcf2019dd628fa7a7abd9",a.default=G},92750:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_chat"};l.hash="41e13c12a815d056441458d26ccd44e2",a.default=l},87065:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_chat"};l.hash="a89e2ef3aa0f92238aa0d73fce6a7cff",a.default=l},13182:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_message"};l.hash="a3edfe280a68f7340ebe0be36940756a",a.default=l},4690:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_onMessageSendChatUpdate_chat"};l.hash="3f09cda2a6e7d19e423600d1197a875f",a.default=l},97048:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_onSuccessUpdater_chat"};l.hash="e187d425ce85c7c5b60fdcf18a7a0a41",a.default=l},49169:function(e,a,n){"use strict";n.d(a,{ZP:function(){return chat_ChatSubscriptionPaywallContextWrapper},rk:function(){return usePayWall},Sz:function(){return usePaywallAndLog}});var l=n(85893),t=n(67294),s=n(22578);n(44311);var i=n(41019),r=n(69208),o=n(28775);let importAnnouncement=()=>n.e(7130).then(n.bind(n,97130));var subscription_MwebAndroidSubscriptionAnnouncementModalOpener=e=>{let{viewer:a}=e,u=(0,s.useFragment)(n(89116),a),[d]=(0,s.useMutation)(n(95851)),c=(0,t.useContext)(r.c),g=!c.isEmbed&&u.shouldSeeAndroidSubscriptionAnnouncement,[m,p]=(0,t.useState)(g),b=(0,t.useCallback)(()=>{p(!1),d({variables:{dismissibleType:o.Z.android_subs_announcement},onCompleted:()=>{p(!1)}})},[p,d]),y=(0,t.useMemo)(()=>({closeAnnouncement:b}),[b]);return(0,l.jsx)(i.Z,{isOpen:m,onRequestClose:b,body:importAnnouncement,bodyProps:y,modalHeight:200,useMinHeight:!0})},u=n(81534);let d=[3002,3004],WebSpeedUpsellModalOpener_importAnnouncement=()=>n.e(5953).then(n.bind(n,25953));var subscription_WebSpeedUpsellModalOpener=e=>{var a;let{bot:u,viewer:c}=e,g=(0,s.useFragment)(n(66856),u),m=(0,s.useFragment)(n(22234),c),[p]=(0,s.useMutation)(n(68222)),b=(0,t.useContext)(r.c),y=!b.isEmbed&&d.includes(g.botId)&&m.shouldSeeResponseSpeedUpsell&&!m.shouldSeeWebSubscriptionAnnouncement&&!(null===(a=m.subscription)||void 0===a?void 0:a.isActive),[h,k]=(0,t.useState)(y),f=(0,t.useCallback)(()=>{k(!1),p({variables:{dismissibleType:o.Z.response_speed_upsell},onCompleted:()=>{k(!1)}})},[k,p]),_=(0,t.useMemo)(()=>({viewer:m,closeAnnouncement:f}),[m,f]);return(0,l.jsx)(i.Z,{isOpen:h,onRequestClose:f,body:WebSpeedUpsellModalOpener_importAnnouncement,bodyProps:_,useMinHeight:!0})},c=n(41143),g=n.n(c);let WebSubscriptionAnnouncementModalOpener_importAnnouncement=()=>n.e(2334).then(n.bind(n,92334));var subscription_WebSubscriptionAnnouncementModalOpener=e=>{var a,u;let{bot:d,viewer:c}=e,m=(0,s.useFragment)(n(60867),d),p=(0,s.useFragment)(n(99343),c),[b]=(0,s.useMutation)(n(60943)),y=null===(a=p.poeUser)||void 0===a?void 0:a.creationTime;g()(!!y,"Viewer creation time cannot be empty!");let h=y/1e3,k=Date.now()-h>=864e5,f=(0,t.useContext)(r.c),_=!f.isEmbed&&p.shouldSeeWebSubscriptionAnnouncement&&!(null===(u=p.subscription)||void 0===u?void 0:u.isActive)&&m.isSystemBot&&k,[S,F]=(0,t.useState)(_),v=(0,t.useCallback)(()=>{F(!1),b({variables:{dismissibleType:o.Z.web_subs_announcement},onCompleted:()=>{F(!1)}})},[F,b]),C=(0,t.useMemo)(()=>({closeAnnouncement:v}),[v]);return(0,l.jsx)(i.Z,{isOpen:S,onRequestClose:v,body:WebSubscriptionAnnouncementModalOpener_importAnnouncement,bodyProps:C,modalHeight:200,useMinHeight:!0})},m=n(75408),p=n(18974),b=n(77614),y=n(96676),h=n(47128);let k={shouldPromptSubscription:!1,shouldShowRateLimitedBanner:!1,setPaywallVisible:()=>{}},usePayWall=()=>{let{shouldPromptSubscription:e,shouldShowRateLimitedBanner:a,setPaywallVisible:n}=t.useContext(f),l=(0,t.useCallback)(()=>{n(!1)},[n]),s=(0,t.useCallback)(()=>{n(!0)},[n]);return{shouldPromptSubscription:e,shouldShowRateLimitedBanner:a,openPaywall:s,closePaywall:l}},usePaywallAndLog=e=>{let{bot:a}=e,l=(0,s.useFragment)(n(35363),a),{openPaywall:i,shouldPromptSubscription:r}=usePayWall(),{logClick:o}=(0,u.B)(l),d=(0,t.useCallback)(()=>{o(b.Z.limited_access_bot),i()},[o,i]);return{shouldPromptSubscription:r,openPaywallAndLog:d}},importPaywallModal=()=>Promise.all([n.e(7846),n.e(576),n.e(4247)]).then(n.bind(n,26261)),f=t.createContext(k);var chat_ChatSubscriptionPaywallContextWrapper=e=>{var a;let{bot:i,viewer:r,children:o}=e,u=(0,s.useFragment)(n(99747),i),d=(0,s.useFragment)(n(47252),r);(0,m.fN)();let[c,g]=(0,t.useState)(!1),b=(0,t.useCallback)(()=>{g(!1)},[g]),_=null===(a=d.subscription)||void 0===a?void 0:a.isActive,S=0===u.messageLimit.dailyLimit&&u.limitedAccessType===p.Z.no_limit&&!d.isEligibleForWebSubscriptions,F=d.useNewLimitSystem?u.messageUsageLimit.shouldPromptSubscription:!_&&!u.messageLimit.canSend&&!S,v=d.useNewLimitSystem?u.messageUsageLimit.shouldShowLimitInfoBanner:u.messageLimit.shouldShowSubscriptionRationale,C=(0,t.useMemo)(()=>({shouldPromptSubscription:F,shouldShowRateLimitedBanner:v,setPaywallVisible:g}),[F,v,g]),M=!!d.poeUser;(0,h.Z)({viewer:d});let K=(0,t.useMemo)(()=>({botId:u.botId}),[u]);return(0,l.jsxs)(f.Provider,{value:M?C:k,children:[o,M&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.Suspense,{fallback:null,children:!_&&c&&(0,l.jsx)(y.Z,{body:importPaywallModal,bodyProps:K,onRequestClose:b,bot:u})}),(0,l.jsx)(subscription_WebSubscriptionAnnouncementModalOpener,{bot:u,viewer:d}),(0,l.jsx)(subscription_MwebAndroidSubscriptionAnnouncementModalOpener,{viewer:d}),(0,l.jsx)(subscription_WebSpeedUpsellModalOpener,{bot:u,viewer:d})]})]})}},3847:function(e,a,n){"use strict";n.d(a,{Z:function(){return es}});var l,t,s,i=n(85893),r=n(11163),o=n(67294),u=n(22120),d=n(22578),c=n(2012),g=n(32260),m=n(37650),p=n(67991),b=n(8655),y=n(38154),h=n.n(y),k=n(69295),f=n(1656),_=n(70442),S=n.n(_),inputFooter_ChatMessageFileInputButton=e=>{let{onFileUpload:a,...n}=e,l=(0,o.useRef)(null),t=(0,o.useCallback)(()=>{var e;null==l||null===(e=l.current)||void 0===e||e.click()},[]),s=(0,o.useCallback)(e=>{if(e.target.files){let n=Array.from(e.target.files);e.target.value="",a(n)}},[a]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(k.t9,{className:S().button,onClick:t,...n,children:(0,i.jsx)(f.Z,{})}),(0,i.jsx)("input",{className:S().input,ref:l,type:"file",multiple:!0,onChange:s})]})},F=n(39620),v=n(34616),C=n(25432),M=n.n(C),patterns_Dismissable=e=>{let{children:a,onDismiss:n,className:l}=e,t=(0,o.useCallback)(e=>{e.stopPropagation(),n()},[n]);return(0,i.jsxs)("div",{className:(0,v.$)(M().dismissableContainer,l),children:[a,(0,i.jsx)("button",{className:M().dismissButton,onClick:t,children:(0,i.jsx)(F.Z,{className:M().icon})})]})},K=n(81791),w=n.n(K),patterns_HorizontallyScrollable=e=>{let{children:a,className:n}=e,l=(0,o.useRef)(null),t=(0,o.useCallback)(e=>{l.current&&(e.preventDefault(),e.stopPropagation(),l.current.scrollLeft+=e.deltaY,l.current.scrollLeft+=e.deltaX)},[]);return(0,o.useEffect)(()=>{let e=l.current;return e&&e.addEventListener("wheel",t),()=>{e&&e.removeEventListener("wheel",t)}},[t]),(0,i.jsx)("div",{ref:l,className:(0,v.$)(w().container,n),children:a})},L=n(47180),T=n.n(L);let ChatMessageInputAttachment=e=>{let{file:a,index:n,onDismiss:l}=e,t=(0,o.useCallback)(()=>{l(n)},[l,n]);return(0,i.jsx)(patterns_Dismissable,{onDismiss:t,children:(0,i.jsx)(g.Z,{name:a.name,size:a.size,mimeType:a.type,file:a})})};var inputFooter_ChatMessageInputAttachments=e=>{let{files:a,fileIds:n,onFileRemoved:l}=e,t=(0,o.useCallback)(e=>{l(e)},[l]);return a.length?(0,i.jsx)(patterns_HorizontallyScrollable,{className:T().container,children:a.map((e,a)=>(0,i.jsx)(ChatMessageInputAttachment,{file:e,index:a,onDismiss:t},n[a]))}):null};n(44311);var x=n(8787),I=n(6890),A=n(92002),D=n.n(A),E=n(18974);let MessageLimitTooltip=e=>{let{bot:a,viewer:l}=e,{t}=(0,u.$G)(),{messageLimit:s,messageUsageLimit:r,baseModelDisplayName:o,limitedAccessType:g,isApiBot:m}=(0,d.useFragment)(n(46348),a),{useNewLimitSystem:p}=(0,d.useFragment)(n(28217),l),{shouldShowRemainingMessageCount:b,numMessagesRemaining:y}=s,{balanceTooltipText:h}=r,{isLoggedInUser:k}=(0,c.b)(),f=(0,I.a)(),_=!k&&f,S=p||_?!!r.balanceTooltipText:b;return S?(0,i.jsx)("div",{className:D().noFreeMessageTooltip,children:p||_?h:g!==E.Z.no_limit||m?o?t("{{baseModelDisplayName}}: {{numMessagesRemaining}} left",{baseModelDisplayName:o,numMessagesRemaining:y}):t("{{numMessagesRemaining}} left",{numMessagesRemaining:y}):t("Standard bots: {{numMessagesRemaining}} left",{numMessagesRemaining:y})}):null};var inputFooter_ChatMessageSendButton=e=>{let{bot:a,viewer:l,className:t,...s}=e,r=(0,d.useFragment)(n(72612),a),o=(0,d.useFragment)(n(19117),l);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(k.DF,{className:(0,v.$)(D().sendButton,t),...s,children:(0,i.jsx)(x.Z,{})}),(0,i.jsx)(MessageLimitTooltip,{bot:r,viewer:o})]})},N=n(35409),R=n(71953),B=n.n(R);let useValueChangeListeners=e=>{let a=(0,o.useRef)([]),n=(0,o.useCallback)(e=>{a.current.forEach(a=>a(e))},[]),l=(0,o.useCallback)(e=>{n(e.target.value)},[n]),t=(0,o.useCallback)(n=>{if(a.current.push(n),1===a.current.length){var t;null===(t=e.current)||void 0===t||t.addEventListener("input",l)}},[e,l]),s=(0,o.useCallback)(n=>{if(a.current=a.current.filter(e=>e!==n),0===a.current.length){var t;null===(t=e.current)||void 0===t||t.removeEventListener("input",l)}},[e,l]);return(0,o.useEffect)(()=>()=>{var a;null===(a=e.current)||void 0===a||a.removeEventListener("input",l)},[e,l]),{addValueChangedListener:t,removeValueChangedListener:s,onValueChange:n}},V=(0,o.forwardRef)((e,a)=>{let{className:n,onInput:l,onChange:t,footer:s,...r}=e,u=(0,o.useRef)(null),d=(0,o.useRef)(null),c=(0,o.useCallback)(()=>{u.current&&d.current&&(u.current.dataset.replicatedValue=d.current.value)},[]),g=(0,o.useCallback)(e=>{null==l||l(e),c()},[l,c]),{addValueChangedListener:m,removeValueChangedListener:p,onValueChange:b}=useValueChangeListeners(d);return(0,o.useImperativeHandle)(a,()=>({focus:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.focus()},blur:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.blur()},addEventListener:(e,a,n)=>{var l;return null===(l=d.current)||void 0===l?void 0:l.addEventListener(e,a,n)},removeEventListener:(e,a,n)=>{var l;return null===(l=d.current)||void 0===l?void 0:l.removeEventListener(e,a,n)},getValue:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.value},setValue:e=>{d.current&&(d.current.value=e,d.current.scrollTo(0,d.current.scrollHeight),c(),b(e))},addValueChangedListener:m,removeValueChangedListener:p}),[c,m,p,b]),(0,i.jsxs)("div",{className:(0,v.$)(B().growWrap,n),ref:u,children:[(0,i.jsx)("textarea",{className:B().textArea,ref:d,rows:1,onInput:g,onChange:t,...r}),s]})});V.displayName="GrowingTextArea";var O=n(52667);(l=t||(t={}))[l.BACKSPACE=8]="BACKSPACE",l[l.TAB=9]="TAB",l[l.ENTER=13]="ENTER",l[l.SPACE=32]="SPACE",l[l.ESC=27]="ESC",l[l.UP=38]="UP",l[l.DOWN=40]="DOWN",l[l.PAGE_UP=33]="PAGE_UP",l[l.PAGE_DOWN=34]="PAGE_DOWN",l[l.HOME=36]="HOME",l[l.END=35]="END";var U=t,P=n(77614),j=n(81534),W=n(49169);let getLastHumanMessageText=e=>{if(!e)return null;for(let a=e.length-1;a>=0;a--){let{node:l}=(0,d.readInlineData)(n(87330),e[a]);if((0,O.Q1)(l))return l.text}return null},useOnKeyDown=(e,a,l,t,s,i,r)=>{let u=(0,d.useFragment)(n(91963),e),{shouldPromptSubscription:c,openPaywall:g}=(0,W.rk)(),m=(0,o.useCallback)(e=>{e.preventDefault(),c?(s(P.Z.limited_access_bot),g()):r?i():l()},[c,g,s,l,i,r]),p=(0,o.useCallback)(e=>{var n,l;if(!(null===(n=a.current)||void 0===n?void 0:n.getValue())){e.preventDefault();let n=getLastHumanMessageText(u);n&&(null===(l=a.current)||void 0===l||l.setValue(n),t())}},[u,a,t]);return(0,o.useCallback)(e=>{e.shiftKey||e.keyCode!=U.ENTER?e.keyCode==U.UP&&p(e):m(e)},[m,p])},Z=(0,o.forwardRef)((e,a)=>{let{edges:l,bot:t,className:s,submitMessage:r,onChange:u,disabled:c,footer:g,placeholderText:p}=e,y=(0,d.useFragment)(n(73938),l),h=(0,d.useFragment)(n(9883),t),k=(0,o.useRef)(null),{logClick:f}=(0,j.B)(h),{shouldShowSignupWall:_,openSignupWall:S}=(0,N.zl)(),F=(0,o.useCallback)(()=>{var e;null===(e=k.current)||void 0===e||e.setValue(""),S(N.dh.sendMessage)},[S]),v=(0,m.lR)(h),C=_&&v,M=useOnKeyDown(y,k,r,u,f,F,C),{shouldPromptSubscription:K,openPaywall:w}=(0,W.rk)(),L=(0,o.useCallback)(()=>{var e;null===(e=k.current)||void 0===e||e.setValue(""),f(P.Z.limited_access_bot),w()},[f,w]),T=(0,o.useMemo)(()=>(0,b.Z)([k,a]),[k,a]),x=K?L:C?F:void 0;return(0,i.jsx)(V,{ref:T,className:s,placeholder:p,onFocus:x,onInput:x,onChange:u,onKeyDown:M,disabled:c,footer:g})});Z.displayName="ChatMessageTextArea";var H=n(41143),G=n.n(H),z=n(63236);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}var microphone=function(e){return o.createElement("svg",_extends({viewBox:"0 0 16 27",xmlns:"http://www.w3.org/2000/svg"},e),s||(s=o.createElement("path",{clipRule:"evenodd",d:"M4.235 1.803C4.848.823 6.013 0 8 0c1.986 0 3.152.824 3.765 1.803a3.826 3.826 0 0 1 .568 1.836V3.664s0 .003-1 .003h1v10.666h-1 1v.028a1.823 1.823 0 0 1-.01.176 3.827 3.827 0 0 1-.558 1.66C11.152 17.177 9.986 18 8 18c-1.987 0-3.152-.824-3.765-1.803a3.828 3.828 0 0 1-.568-1.836V14.336s0-.003 1-.003h-1V3.667h1-1v-.028a2.004 2.004 0 0 1 .01-.176 3.827 3.827 0 0 1 .558-1.66Zm1.432 1.874.002-.036a1.828 1.828 0 0 1 .262-.778C6.152 2.51 6.653 2 8 2s1.848.51 2.069.863a1.83 1.83 0 0 1 .264.814v10.646l-.002.036a1.83 1.83 0 0 1-.262.778c-.221.353-.722.863-2.07.863-1.346 0-1.847-.51-2.068-.863a1.828 1.828 0 0 1-.264-.814V3.677Zm-4.334 4.99a1 1 0 0 1 1 1v4.666l.001.03a5.657 5.657 0 0 0 .087.725c.09.49.27 1.13.62 1.76a4.464 4.464 0 0 0 1.62 1.69c.76.457 1.827.795 3.339.795s2.579-.338 3.34-.795a4.464 4.464 0 0 0 1.62-1.69c.349-.63.528-1.27.62-1.76a5.642 5.642 0 0 0 .086-.724V9.667a1 1 0 1 1 2 0v4.666h-1 1v.035a3.958 3.958 0 0 1-.016.302 7.653 7.653 0 0 1-.104.783 7.85 7.85 0 0 1-.839 2.366 6.464 6.464 0 0 1-2.338 2.434c-.902.541-2.013.914-3.37 1.037v3.377h4.334a1 1 0 0 1 0 2H2.667a1 1 0 1 1 0-2H7v-3.378c-1.356-.122-2.467-.495-3.369-1.036a6.463 6.463 0 0 1-2.339-2.434 7.852 7.852 0 0 1-.838-2.366 7.66 7.66 0 0 1-.118-1.015 3.637 3.637 0 0 1-.002-.07v-.032s0-.003 1-.003h-1V9.667a1 1 0 0 1 1-1Z"})))},q=n(62341),Y=n(19029),$=n(74929),Q=n(47986),X=n.n(Q),J=n(6488),ee=n(39885);let getSpeechRecognition=()=>{let{userAgent:e}=window.navigator;return(0,$.P)(e)?null:"undefined"!=typeof SpeechRecognition?SpeechRecognition:"undefined"!=typeof webkitSpeechRecognition?webkitSpeechRecognition:null},getMessageFromErrorEvent=(e,a)=>{switch(a.error){case"no-speech":return e("No speech was detected. Try again.");case"audio-capture":return e("No microphone was found. Ensure that a microphone is installed and that microphone settings are configured correctly.");case"not-allowed":return e("Permission to use microphone was denied. Update your browser permission settings and try again.");case"network":return e("A network error occurred. Check your internet connection and try again.");case"language-not-supported":return e("The language {{language}} is not supported by your browser.",{language:(null==a?void 0:a.target)&&"lang"in a.target&&a.target.lang||"en"});case"aborted":if("No speech detected"===a.message)return e("No speech was detected. Try again.");return null;default:return e("An error occurred: {{error}}",{error:a.error})}};let SpeechRecognitionError=class SpeechRecognitionError extends q.n9{constructor(e){let a=[e.error,e.message].filter(Boolean).join(": ");super(a),this.name="SpeechRecognitionError"}};let logErrorEvent=e=>{("aborted"!==e.error||"No speech detected"===e.message)&&(0,q.H)(new SpeechRecognitionError(e))},createRecognition=e=>{let{onStart:a,onEnd:n,onError:l,onResult:t}=e,s=getSpeechRecognition();G()(s,"SpeechRecognition is not supported");let i=new s;return i.continuous=!0,i.interimResults=!0,i.onstart=a,i.onspeechend=()=>{i.stop()},i.onend=n,i.onerror=l,i.onresult=t,i},useSpeechRecognition=(e,a,n)=>{let{t:l}=(0,u.$G)(),[t,s]=(0,o.useState)(!1),i=(0,o.useRef)(!1),r=(0,o.useCallback)(()=>i.current,[]),d=(0,o.useContext)(z.Z),c=(0,o.useRef)(null),g=(0,o.useCallback)(()=>{var e;null===(e=c.current)||void 0===e||e.stop(),c.current=null},[]),m=(0,o.useCallback)(()=>{var e;null===(e=c.current)||void 0===e||e.abort(),c.current=null},[]),p=(0,o.useCallback)(()=>{var t;let r=(null===(t=e.current)||void 0===t?void 0:t.getValue())||"",o=null==d?void 0:d.botId,u=null==d?void 0:d.model,m=null==d?void 0:d.chatId,p=createRecognition({onStart:()=>{var a,n;null===(a=e.current)||void 0===a||a.blur(),null===(n=e.current)||void 0===n||n.addEventListener("focus",g),s(!0),(0,Y.Z)("poe/action_log",{action_type:(0,ee.E)(J.Z.start_voice_record),bot_id:o,chat_id:m,model_name:u})},onEnd:()=>{var a,n;s(!1),null===(a=e.current)||void 0===a||a.focus(),null===(n=e.current)||void 0===n||n.removeEventListener("focus",g),(0,Y.Z)("poe/action_log",{action_type:(0,ee.E)(J.Z.finish_voice_record),bot_id:o,chat_id:m,model_name:u})},onError:e=>{logErrorEvent(e);let a=getMessageFromErrorEvent(l,e);if(a){var t;null===(t=n.current)||void 0===t||t.setTooltip(a)}},onResult:n=>{let{results:l}=n;if(c.current===p){let n=Array.from(l).filter(e=>e[0].confidence>0).map(e=>e[0].transcript).join("");if(n){var t;i.current=!0,null===(t=e.current)||void 0===t||t.setValue(r+n),a()}}}});c.current=p,p.start()},[e,a,s,n,g,l,d]);return(0,o.useEffect)(()=>{let a=e.current,resetVoiceInputWhenClearInput=e=>{""==e&&(i.current=!1)};return null==a||a.addValueChangedListener(resetVoiceInputWhenClearInput),()=>{null==a||a.removeValueChangedListener(resetVoiceInputWhenClearInput)}},[e]),(0,o.useEffect)(()=>()=>{m()},[m]),{isRunning:t,startRecognition:p,stopRecognition:g,abortRecognition:m,getVoiceInputUsed:r}},ea=(0,o.forwardRef)((e,a)=>{let[n,l]=(0,o.useState)(null),[t,s]=(0,o.useState)(0),r=(0,o.useRef)(null);return(0,o.useImperativeHandle)(a,()=>({setTooltip:e=>{l(e),s(e=>e+1),null!==r.current&&clearTimeout(r.current),r.current=window.setTimeout(()=>{l(null)},5e3)}}),[]),n?(0,i.jsx)("div",{className:X().tooltip,children:n},t):null});ea.displayName="Tooltip";let en=(0,o.forwardRef)((e,a)=>{let{className:n,chatInputRef:l,onInputChange:t,userHasNoMessagesLeft:s,...r}=e,{shouldShowSignupWall:u,openSignupWall:d}=(0,N.zl)(),c=(0,o.useCallback)(()=>{d(N.dh.sendMessage)},[d]),g=(0,o.useRef)(null),{isRunning:m,startRecognition:p,stopRecognition:b,abortRecognition:y,getVoiceInputUsed:h}=useSpeechRecognition(l,t,g);return(0,o.useImperativeHandle)(a,()=>({startRecognition:p,stopRecognition:b,abortRecognition:y,getVoiceInputUsed:h}),[p,b,y,h]),(0,i.jsxs)(k.t9,{className:(0,v.$)(X().button,n),onClick:u&&s?c:m?b:p,"aria-selected":!!m,...r,children:[(0,i.jsx)(ea,{ref:g}),(0,i.jsx)(microphone,{})]})});en.displayName="ChatMessageVoiceInputButtonInner";let el=(0,o.forwardRef)((e,a)=>{let[n,l]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{l(!!getSpeechRecognition())},[]),n?(0,i.jsx)(en,{ref:a,...e}):null});el.displayName="ChatMessageVoiceInputButton";let useIsBotDisabled=e=>{let a=(0,d.useFragment)(n(61251),e),{isDeleted:l}=(0,m.iZ)(a);return l||a.isDown},getFileSizeErrorMessage=(e,a,n)=>{let l=(0,g.t)(e);return a<=1?n("The file you tried to attach is too large. Please try uploading a file that is less than {{fileSizeLimit}}.",{fileSizeLimit:l}):a>1?n("The files you tried to attach are too large. Please try uploading files that are less than {{fileSizeLimit}} total.",{fileSizeLimit:l}):void 0},getInvalidFileTypeErrorMessage=(e,a)=>e<=1?a("The file you tried to attach has an unsupported file type."):e>1?a("The files you tried to attach have unsupported file types."):void 0,et=(0,o.forwardRef)((e,a)=>{let{bot:l,viewer:t,edges:s,onSubmitMessage:g,placeholderText:y,isBotResponding:k,fileHandlerRef:f}=e,_=(0,d.useFragment)(n(5466),l),S=(0,d.useFragment)(n(42785),s),F=(0,d.useFragment)(n(50467),t),v=(0,o.useRef)(0),C=(0,o.useRef)(0),M=(0,o.useRef)(0),K=(0,o.useRef)(new WeakMap),[w,L]=(0,o.useState)([]),T=(0,o.useRef)(null),{t:x}=(0,u.$G)(),I=(0,r.useRouter)(),{isLoggedInUser:A}=(0,c.b)(),D=(0,m.lR)(_),E=_.uploadFileSizeLimit,N=(0,o.useCallback)(e=>{let a=e.filter(e=>(0,p.dD)(e.type)||_.allowsImageAttachments||_.isApiBot&&_.supportsFileUpload),n=a.filter(e=>e.size<E||_.allowsImageAttachments);n.forEach(e=>{K.current.set(e,v.current++),M.current++,(0,p.ay)(e)}),L(e=>[...e,...n]);let l=n.reduce((e,a)=>e+a.size,0);C.current+=l;let t=[],s=a.length<e.length,i=!_.allowsImageAttachments&&C.current>E||n.length<a.length;s&&t.push(getInvalidFileTypeErrorMessage(e.length-a.length,x)),i&&t.push(getFileSizeErrorMessage(E,M.current,x));let r=t.join("\n\n");if(r){var o;null===(o=T.current)||void 0===o||o.setTooltip(r)}},[E,x,_.allowsImageAttachments,_.isApiBot,_.supportsFileUpload]);(0,o.useImperativeHandle)(f,()=>({handleFiles:N}),[N]);let R=(0,o.useCallback)(e=>{var a;L(a=>a.filter((a,n)=>n!==e));let n=w[e].size;C.current-=n,M.current--;let l="";C.current>E&&(l=getFileSizeErrorMessage(E,M.current,x)||""),null===(a=T.current)||void 0===a||a.setTooltip(l)},[w,E,x]),B=(0,o.useCallback)(()=>{L([]),C.current=0,M.current=0},[]),V=w.map(e=>K.current.get(e)||0),O=(0,o.useRef)(null),U=(0,o.useRef)(null),P=(0,o.useMemo)(()=>(0,b.Z)([O,a]),[O,a]),[j,W]=(0,o.useState)(!0),H=(0,o.useCallback)(()=>{var e,a;W((null===(a=O.current)||void 0===a?void 0:null===(e=a.getValue())||void 0===e?void 0:e.trim())==="")},[]),G=useIsBotDisabled(_),z=G||k||j||!_.allowsImageAttachments&&C.current>E,q=(0,o.useCallback)(()=>{var e,a;if(null===(e=U.current)||void 0===e||e.abortRecognition(),navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&(null===(a=O.current)||void 0===a||a.blur()),!z)return g(O,U,w,B)},[O,U,w,B,z,g]),Y=(0,o.useCallback)(()=>{var e;null===(e=O.current)||void 0===e||e.focus()},[O]),$=(0,o.useRef)(!1);(0,o.useEffect)(()=>{var e;(A||!0!==$.current)&&(null===(e=O.current)||void 0===e||e.focus(),$.current=!0)},[_.id,I,A]);let Q=_.allowsImageAttachments||E>0;return(0,i.jsxs)("div",{className:h().inputContainer,onClickCapture:Y,children:[(0,i.jsx)(Z,{ref:P,edges:S,bot:_,className:h().textArea,submitMessage:q,onChange:H,disabled:G,placeholderText:y,footer:(0,i.jsx)(inputFooter_ChatMessageInputAttachments,{files:w,fileIds:V,onFileRemoved:R})}),Q&&(0,i.jsxs)("div",{className:h().fileInput,children:[(0,i.jsx)(inputFooter_ChatMessageFileInputButton,{disabled:G||!_.allowsImageAttachments&&C.current>E,onFileUpload:N}),(0,i.jsx)(ea,{ref:T})]}),(0,i.jsx)(el,{ref:U,className:h().voiceInputButton,chatInputRef:O,onInputChange:H,disabled:G,userHasNoMessagesLeft:D}),(0,i.jsx)(inputFooter_ChatMessageSendButton,{className:h().sendButton,bot:_,viewer:F,onClick:q,disabled:z})]})});et.displayName="ChatMessageInputContainer";var es=et},77358:function(e,a,n){"use strict";n.d(a,{O:function(){return l}});let l={year:"numeric",month:"short",day:"numeric"}},47128:function(e,a,n){"use strict";n.d(a,{Z:function(){return WebSubscriptionSuccessMessage}});var l,t=n(85893),s=n(41664),i=n.n(s),r=n(11163),o=n(67294),u=n(22120),d=n(22578);n(44311);var c=n(46857),g=n(55625),m=n(90912),p=n.n(m);(l||(l={})).multiple_free_trials="multiple_free_trials";var b=l,y=n(77358),h=n(2197),WebSubscriptionSuccessMessage=e=>{let{viewer:a}=e,{t:l}=(0,u.$G)(),s=(0,d.useFragment)(n(23196),a),m=(0,h.ZP)(),k=(0,r.useRouter)();(0,o.useEffect)(()=>{var e;if(null===(e=k.query)||void 0===e?void 0:e.subscribed){let e=s.subscription;if(null==e?void 0:e.isActive){(0,c.hP)("sng_subscribe");let{expiresTime:a,willCancelAtPeriodEnd:n}=e,s=a?n?l("Your plan expires on {{val, datetime}}",{val:new Date(a/1e3),formatParams:{val:y.O}}):l("Your plan automatically renews on {{val, datetime}}",{val:new Date(a/1e3),formatParams:{val:y.O}}):null,i=(0,t.jsxs)(t.Fragment,{children:[l("Successfully subscribed to Poe.")," ",a&&(0,t.jsx)(t.Fragment,{children:s})]});m({content:i,type:h.pC.success}),(0,g.CS)(k,"subscribed")}else if((null==e?void 0:e.purchaseRevocationReason)==b.multiple_free_trials){let e=(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("p",{children:[(0,t.jsx)("div",{className:p().ToastTitle,children:l("Your subscription payment method failed.")}),(0,t.jsx)("div",{className:p().ToastText,children:(0,t.jsxs)(u.cC,{i18nKey:"freeTrialRevokedError",shouldUnescape:!0,children:["Your payment method has already been used to access a subscription free trial. You can resubscribe at any time by going to"," ",(0,t.jsx)(i(),{href:(0,g.qm)("/settings"),target:"_blank",className:p().ToastLink,children:"poe.com/settings"}),"."]})})]})});m({content:e,type:h.pC.error,duration:15e3}),(0,g.CS)(k,"subscribed")}}},[])}},60030:function(e,a,n){"use strict";var l=n(44311),t=n(89083);a.Z=e=>{let{defaultBotObject:a}=(0,l.readInlineData)(n(38117),e);return a.hasMarkdownRendering?t.Z.text_markdown:t.Z.text_plain}},27488:function(e,a,n){"use strict";n.d(a,{f:function(){return setMessageState},m:function(){return createLocalChatMessage}});var l=n(41143),t=n.n(l);n(44311),n(16761);let createLocalFile=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"File");return t()("File"===n.getType(),"Expected ".concat(a.id," to be a File, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.mimeType,"mimeType"),n.setValue(a.size,"size"),n.setValue(a.token,"token"),n},createLocalMessageAttachment=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"Attachment");return t()("Attachment"===n.getType(),"Expected ".concat(a.id," to be an Attachment, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.name,"name"),n.setLinkedRecord(createLocalFile(e,a.file),"file"),n},createLocalChatMessage=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"Message");return t()("Message"===n.getType(),"Expected ".concat(a.id," to be a Message, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.messageId,"messageId"),n.setValue(a.attachmentTruncationState,"attachmentTruncationState"),n.setValue(a.author,"author"),n.setValue(a.clientNonce,"clientNonce"),n.setValue(a.contentType,"contentType"),n.setValue(a.creationTime,"creationTime"),n.setValue(a.isOptimistic,"isOptimistic"),n.setValue(a.messageId,"messageId"),n.setValue(a.sourceType,"sourceType"),n.setValue(a.state,"state"),n.setValue(a.suggestedReplies.slice(),"suggestedReplies"),n.setValue(a.text,"text"),n.setValue(a.textLengthOnCancellation,"textLengthOnCancellation"),n.setValue(a.timeoutLevel,"timeoutLevel"),n.setValue(a.vote,"vote"),n.setLinkedRecords(a.attachments.map(a=>createLocalMessageAttachment(e,a)),"attachments"),n},setMessageState=(e,a)=>{t()("Message"===e.getType(),"Cannot set status of record of type ".concat(e.getType())),e.setValue(a,"state")}},52667:function(e,a,n){"use strict";n.d(a,{OE:function(){return isBotMessage},Q1:function(){return isHumanMessage},hb:function(){return isChatBreak}});var l=n(22578),t=n(85649);let isBotMessage=e=>{if(!e)return!1;let a=(0,l.readInlineData)(n(97605),e);return!isHumanMessage(a)&&!isChatBreak(a)},isHumanMessage=e=>{if(!e)return!1;let a=(0,l.readInlineData)(n(45963),e);return a.author===t.Z.human},isChatBreak=e=>{if(!e)return!1;let a=(0,l.readInlineData)(n(45817),e);return a.author===t.Z.chat_break}},44912:function(e,a,n){"use strict";n.d(a,{Ci:function(){return replaceMessageInChat},Ey:function(){return getLastMessage},OJ:function(){return addMessageToChat},T5:function(){return removeMessageFromChat},WL:function(){return clearOptimisticMessages},kz:function(){return replaceOrAddMessageEdgeInChat},n3:function(){return addMessageRecordToChat}});var l=n(41143),t=n.n(l),s=n(44311),i=n(81032);let getChatConnection=e=>{t()("Chat"===e.getType(),"Cannot add messages to a record of type ".concat(e.getType()));let a=s.ConnectionHandler.getConnection(e,i.U);return t()(a,"Cannot find connection ".concat(i.U)),a},r=n(51151),isMessageInChat=(e,a)=>{let n=getChatConnection(e),l=n.getLinkedRecords("edges");if(!l)return!1;let t=l.map(e=>{var a;return null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getDataID()});return t.includes(a)},getLastMessage=e=>{let a=getChatConnection(e),n=a.getLinkedRecords("edges");t()(n,"No edges found in chat connection");let l=n.sort((e,a)=>{var n,l;let s=null===(n=e.getLinkedRecord("node"))||void 0===n?void 0:n.getValue("creationTime"),i=null===(l=a.getLinkedRecord("node"))||void 0===l?void 0:l.getValue("creationTime");return t()(s,"Node A time is ".concat(s)),t()(i,"Node B time is ".concat(i)),s<i?-1:1}),s=l[n.length-1];return null==s?void 0:s.getLinkedRecord("node")},addMessageToChat=(e,a,n)=>{let l=(0,s.readInlineData)(r,n),i=e.get(l.id);return t()(i,"Cannot find message record with id ".concat(l.id)),addMessageRecordToChat(e,a,i)},addMessageRecordToChat=(e,a,n)=>{t()("Chat"===a.getType(),"Cannot add messages to a record of type ".concat(a.getType())),t()("Message"===n.getType(),"Cannot add record of type ".concat(n.getType()," to Chat"));let l=getChatConnection(a),i=s.ConnectionHandler.createEdge(e,l,n,"MessageEdge");return s.ConnectionHandler.insertEdgeAfter(l,i),a.setLinkedRecord(n,"lastMessage"),i},removeMessageFromChat=(e,a)=>{var n;let l=getChatConnection(e);s.ConnectionHandler.deleteNode(l,a);let t=null===(n=getChatConnection(e).getLinkedRecords("edges"))||void 0===n?void 0:n.map(e=>e.getLinkedRecord("node")).filter(e=>(null==e?void 0:e.getDataID())!==a);e.setLinkedRecord((null==t?void 0:t[t.length-1])||null,"lastMessage")},replaceMessageInChat=(e,a,n,l)=>{let i=(0,s.readInlineData)(r,l),o=e.get(i.id);t()("Chat"===a.getType(),"Cannot remove message edges from a record of type ".concat(a.getType())),t()(o,"Unable to find message of id ".concat(i.id));let u=getChatConnection(a),d=u.getLinkedRecords("edges");t()(d,"No edges found in chat connection");let c=d.findIndex(e=>{var a;return(null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getValue("id"))===n});return -1!==c&&(d[c]=s.ConnectionHandler.createEdge(e,u,o,"MessageEdge"),u.setLinkedRecords(d,"edges"),c===d.length-1&&a.setLinkedRecord(o,"lastMessage"),!0)},replaceMessageEdgeInChat=(e,a,n,l)=>{let i=(0,s.readInlineData)(r,l),o=e.get(i.id);t()("Chat"===a.getType(),"Cannot remove message edges from a record of type ".concat(a.getType())),t()(o,"Unable to find message of id ".concat(i.id)),t()("MessageEdge"===n.getType(),"Cannot remove record of type ".concat(n.getType()," from Chat"));let u=getChatConnection(a),d=u.getLinkedRecords("edges");t()(d,"No edges found in chat connection");let c=s.ConnectionHandler.createEdge(e,u,o,"MessageEdge"),g=!1,m=d.map((e,l)=>e.getDataID()===n.getDataID()?(g=!0,l===d.length-1&&a.setLinkedRecord(o,"lastMessage"),c):e);return u.setLinkedRecords(m,"edges"),g},replaceOrAddMessageEdgeInChat=(e,a,n,l)=>{t()("Chat"===a.getType(),"Cannot remove message edges from a record of type ".concat(a.getType())),t()(!n||"MessageEdge"===n.getType(),"Cannot remove record of type ".concat(n?n.getType():n," from Chat"));let i=(0,s.readInlineData)(r,l),o=e.get(i.id),u=isMessageInChat(a,i.id);if(u)return o;let d=!0;if(n&&(d=!replaceMessageEdgeInChat(e,a,n,l)),d){t()(o,"Unable to find message of id ".concat(i.id));let n=getChatConnection(a),l=s.ConnectionHandler.createEdge(e,n,o,"MessageEdge");s.ConnectionHandler.insertEdgeAfter(n,l),a.setLinkedRecord(o,"lastMessage")}return o},clearOptimisticMessages=e=>{let a=getChatConnection(e),n=a.getLinkedRecords("edges");if(n){let l=null;n.forEach(e=>{let n=e.getLinkedRecord("node");(null==n?void 0:n.getValue("isOptimistic"))?s.ConnectionHandler.deleteNode(a,n.getDataID()):l=n}),e.setLinkedRecord(l,"lastMessage")}}},64076:function(e,a,n){"use strict";n.d(a,{Gx:function(){return createOptimisticHumanMessage},dS:function(){return createOptimisticBotMessage},sC:function(){return createOptimisticChatBreak}});var l=n(68220),t=n(85649),s=n(89083),i=n(31268),r=n(8611),o=n(27488);let generateRandomNumber=()=>Math.floor(1e9*Math.random()),generateOptimisticId=(e,a)=>{let n,l;do n=generateRandomNumber(),l="Optimistic-".concat(a,"-").concat(n);while(e.get(l));return[l,n]},createOptimisticHumanMessage=(e,a)=>{let{prompt:n,files:s=[],source:i,clientNonce:u,contentType:d}=a,[c,g]=generateOptimisticId(e,"HumanMessage"),m=s.map(a=>{let[n]=generateOptimisticId(e,"MessageAttachment"),[l]=generateOptimisticId(e,"File");return{id:n,name:a.name,file:{id:l,token:"",url:"",size:a.size,mimeType:a.type}}});return(0,o.m)(e,{id:c,messageId:g,attachmentTruncationState:l.Z.not_truncated,attachments:m,author:t.Z.human,clientNonce:u,contentType:d,creationTime:1e3*Date.now(),hasCitations:!1,isOptimistic:!0,sourceType:i.sourceType,state:r.Z.complete,suggestedReplies:[],text:n,textLengthOnCancellation:null,timeoutLevel:0,vote:null})},createOptimisticBotMessage=(e,a)=>{let{author:n,contentType:t,text:s="",state:u=r.Z.incomplete}=a,[d,c]=generateOptimisticId(e,"BotMessage");return(0,o.m)(e,{id:d,messageId:c,attachmentTruncationState:l.Z.not_truncated,attachments:[],author:n,clientNonce:null,contentType:t,creationTime:1e3*Date.now(),hasCitations:!1,isOptimistic:!0,sourceType:i.Z.chat_input,state:u,suggestedReplies:[],text:s,textLengthOnCancellation:null,timeoutLevel:0,vote:null})},createOptimisticChatBreak=(e,a)=>{let{clientNonce:n}=a,[u,d]=generateOptimisticId(e,"ChatBreakMessage");return(0,o.m)(e,{id:u,messageId:d,attachmentTruncationState:l.Z.not_truncated,attachments:[],author:t.Z.chat_break,clientNonce:n,contentType:s.Z.text_plain,creationTime:1e3*Date.now(),hasCitations:!1,isOptimistic:!0,sourceType:i.Z.chat_input,state:r.Z.complete,suggestedReplies:[],text:"",textLengthOnCancellation:null,timeoutLevel:0,vote:null})}},21774:function(e,a,n){"use strict";n.d(a,{Mo:function(){return clearNonce},Us:function(){return useResendMessage},gc:function(){return setNonceArgs}});var l=n(41143),t=n.n(l),s=n(67294),i=n(22120),r=n(22578),o=n(44311),u=n(18093),d=n(2197),c=n(44912),g=n(38650);let m=new Map,getArgs=e=>{let a=m.get(e);if(!a)throw Error("No args for nonce ".concat(e));return a},setNonceArgs=(e,a)=>m.set(e,a),clearNonce=e=>m.delete(e),resendMessage=e=>{let{environment:a,message:l,chat:s,setToast:i,onSuccessfulMessageSend:r,useBotRecencyOrder:u,t:d}=e,{id:m,isOptimistic:p,clientNonce:b}=(0,o.readInlineData)(n(71669),l),y=(0,o.readInlineData)(n(17048),s);t()(p&&b,"Message must be optimistic to resend");let{optimisticUpdate:h,...k}=getArgs(b);(0,o.commitLocalUpdate)(a,e=>{let a=e.get(y.id);t()(a,"Expected chat record ".concat(y.id," to exist")),(0,c.T5)(a,m)}),a.revertUpdate(h),(0,g.b)({environment:a,chat:y,setToast:i,onSuccessfulMessageSend:r,useBotRecencyOrder:u,t:d,...k})},useResendMessage=e=>{let{message:a,chat:n}=e,l=(0,r.useRelayEnvironment)(),t=(0,d.ZP)(),{t:o}=(0,i.$G)(),{resetLoggedOutTimeout:c}=(0,u.v)();return(0,s.useCallback)(function(){let{onSuccessfulMessageSend:e,useBotRecencyOrder:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};resendMessage({environment:l,message:a,chat:n,setToast:t,onSuccessfulMessageSend:a=>{null==e||e(a),c()},useBotRecencyOrder:s,t:o})},[l,t,a,n,c,o])}},38650:function(e,a,n){"use strict";n.d(a,{$:function(){return useSendMessage},b:function(){return sendMessage}});var l=n(41143),t=n.n(l),s=n(67294),i=n(22120),r=n(22578),o=n(18093),u=n(2197),d=n(37650),c=n(36025),g=n(69208),m=n(46857),p=n(75408),b=n(90578),y=n(50530),h=n(47875),k=n(8611),f=n(81032),_=n(60030),S=n(57708),F=n(27488),v=n(44912),C=n(64076),M=n(21774);let prepareUploadables=e=>{if(!e)return[null,null];let a=Array.from(e).reduce((e,a,n)=>({...e,["file".concat(n)]:a}),{});return[a,Array.from(Object.keys(a))]},K=n(53398),sendMessage=async e=>{let{environment:a,chat:l,prompt:s,source:i,files:o=[],setToast:u,onSuccessfulMessageSend:g=()=>{},clientNonce:p,shouldUpdateChatHistory:k=!0,useBotRecencyOrder:_=!1,t:F}=e;(0,b.Si)();let v=(0,m.h0)(),{id:C,chatId:w,isOptimistic:L,defaultBotObject:T,...x}=(0,r.readInlineData)(n(92750),l),I=p||(0,f.C)(),A={storeUpdater:e=>{k&&!L&&(0,S.x6)(e,C);let a=_?d.A7:d.rY;a(e,T.id)}};L&&k&&(0,r.commitLocalUpdate)(a,e=>{(0,S.x6)(e,C)}),(0,M.gc)(I,{prompt:s,files:o,source:i,optimisticUpdate:A});let{optimisticHumanMessageId:D,optimisticHumanMessageEdgeId:E}=onMessageSendChatUpdate({environment:a,chat:x,prompt:s,files:o,source:i,clientNonce:I}),[N,R]=prepareUploadables(o),B=await v;a.applyUpdate(A),(0,r.commitMutation)(a,{mutation:K,variables:{chatId:L?null:w,shouldFetchChat:!!L,bot:T.nickname,query:s,source:i,clientNonce:I,attachments:R,sdid:B},uploadables:N,updater:(e,a)=>{var n,l,t;if((null===(n=a.messageEdgeCreate)||void 0===n?void 0:n.status)===h.Z.success&&(null===(l=a.messageEdgeCreate)||void 0===l?void 0:l.message)){onSendSuccessUpdater(e,{chat:x,optimisticHumanMessageEdgeId:E,messageData:a.messageEdgeCreate.message.node});let n=a.messageEdgeCreate.chat;L&&n&&newChatUpdater(e,{chat:n,message:a.messageEdgeCreate.message.node,optimisticChatId:C}),k&&(a.messageEdgeCreate.chat?((0,S.eM)(e,C),(0,S.x6)(e,a.messageEdgeCreate.chat.id)):(0,S.x6)(e,C));let l=_?d.A7:d.rY;l(e,T.id)}else onSendFailureUpdater(e,{chatNodeId:C,optimisticHumanMessageEdgeId:E,errorMessage:null===(t=a.messageEdgeCreate)||void 0===t?void 0:t.statusMessage})},onCompleted:e=>{a.revertUpdate(A);let n=onSendMessageCompleted(e,u,D,I);n&&g(e)},onError:()=>{(0,r.commitLocalUpdate)(a,e=>{onSendFailureUpdater(e,{chatNodeId:C,optimisticHumanMessageEdgeId:E,errorMessage:window.navigator.onLine?F("Message failed to send."):F("Unable to send this message. Check your internet connection.")})})}}),t()((0,y.hj)(D),"Expected optimistic human message id to be a number"),(0,c.CE)(D,w)},onMessageSendChatUpdate=e=>{let a,l,{environment:s,chat:i,prompt:o,files:u,source:d,clientNonce:c}=e,{id:g,...m}=(0,r.readInlineData)(n(4690),i),p=(0,_.Z)(m);return(0,r.commitLocalUpdate)(s,e=>{let n=e.get(g);t()(n,"Expected Chat record with id ".concat(g," to exist when sending a message"));let s=(0,C.Gx)(e,{prompt:o,files:u,source:d,clientNonce:c,contentType:p}),i=(0,v.n3)(e,n,s);a=i.getDataID(),l=s.getValue("messageId")}),t()((0,y.hj)(l),"Expected optimistic human message id to be a number"),t()(a,"Expected optimistic human message edge id to exist"),{optimisticHumanMessageId:l,optimisticHumanMessageEdgeId:a}},onSendMessageCompleted=(e,a,n,l)=>{let s=e.messageEdgeCreate.status;if(s!==h.Z.success)return!1;let i=getErrorMessageFromFailedUrls(e.messageEdgeCreate.failedUrls);return i&&a({type:u.pC.error,content:i}),t()(e.messageEdgeCreate.message,"No message on a successful send message mutation"),(0,c.Ot)(n,e.messageEdgeCreate.message.node.messageId),(0,M.Mo)(l),!0},getErrorMessageFromFailedUrls=e=>{if(0===e.length)return null;let a=e[0].reason;if(1===e.length)switch(a){case"fetch_error":return"Failed to fetch ".concat(e[0].url," because of a problem crawling the URL.");case"over_budget":return"Failed to fetch ".concat(e[0].url," because it was too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e[0].url," because it was not a supported content type.");default:return"Failed to fetch ".concat(e[0].url,".")}switch(a){case"fetch_error":return"Failed to fetch ".concat(e.length," urls because of problems crawling them.");case"over_budget":return"Failed to fetch ".concat(e.length," urls because they were too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e.length," urls because of unsupported content types.");default:return"Failed to fetch ".concat(e.length," urls.")}},onSendSuccessUpdater=(e,a)=>{let{chat:l,optimisticHumanMessageEdgeId:s,messageData:i}=a,{id:o,defaultBotObject:u,...d}=(0,r.readInlineData)(n(97048),l),c=e.get(o),g=e.get(s);t()(c,"Expected Chat record with id ".concat(o," to exist when sending a message"));let m=(0,v.kz)(e,c,g,i),p=(0,v.Ey)(c);if((null==p?void 0:p.getDataID())===(null==m?void 0:m.getDataID())){let a=(0,_.Z)(d),n=(0,C.dS)(e,{contentType:a,author:u.nickname});(0,v.n3)(e,c,n)}},newChatUpdater=(e,a)=>{let{chat:l,message:s,optimisticChatId:i}=a,o=(0,r.readInlineData)(n(87065),l),{id:u}=(0,r.readInlineData)(n(13182),s);(0,p.mK)(o.chatId,i);let d=e.get(o.id);t()(d,"Cannot find chat record with id ".concat(o.id)),e.getRoot().setLinkedRecord(d,"chatOfCode",{chatCode:o.chatCode});let c=(0,v.Ey)(d);if((null==c?void 0:c.getDataID())===u){let a=(0,_.Z)(o),n=(0,C.dS)(e,{contentType:a,author:o.defaultBotObject.nickname});(0,v.n3)(e,d,n)}},onSendFailureUpdater=(e,a)=>{var n;let{chatNodeId:l,optimisticHumanMessageEdgeId:s,errorMessage:i}=a,r=e.get(l),o=null===(n=e.get(s))||void 0===n?void 0:n.getLinkedRecord("node");t()(r,"Expected Chat record with id ".concat(l," to exist when sending a message")),t()(o,"Expected optimistic human message to exist after sending a message"),(0,F.f)(o,k.Z.error),o.setValue(i,"errorMessage")},useSendMessage=e=>{let{source:a,chat:n}=e,l=(0,r.useRelayEnvironment)(),t=(0,u.ZP)(),{resetLoggedOutTimeout:d}=(0,o.v)(),c=(0,s.useContext)(g.c),{t:m}=(0,i.$G)(),p=(0,s.useCallback)(async e=>{let{prompt:s,files:i,source:r,onSuccessfulMessageSend:o,clientNonce:u,useBotRecencyOrder:g}=e;return await sendMessage({environment:l,chat:n,prompt:s,files:i,source:r||a,setToast:t,onSuccessfulMessageSend:e=>{null==o||o(e),d()},clientNonce:u,shouldUpdateChatHistory:!c.isEmbed,useBotRecencyOrder:g,t:m})},[n,l,t,a,d,c,m]);return p}},8655:function(e,a,n){"use strict";n(67294),a.Z=function(e){return a=>{e.forEach(e=>{"function"==typeof e?e(a):null!=e&&(e.current=a)})}}},68220:function(e,a){"use strict";var n,l;(l=n||(n={})).not_truncated="not_truncated",l.truncated="truncated",l.parse_failure="parse_failure",a.Z=n},31268:function(e,a){"use strict";var n,l;(l=n||(n={})).welcome_topic="welcome_topic",l.linked_phrase="linked_phrase",l.suggested_reply="suggested_reply",l.chat_input="chat_input",l.continue_conversation="continue_conversation",l.quora_machine_answer_interaction="quora_machine_answer_interaction",l.quora_ask_new_question_interaction="quora_ask_new_question_interaction",l.conversation_starter="conversation_starter",a.Z=n},70442:function(e){e.exports={button:"ChatMessageFileInputButton_button___6Emy",input:"ChatMessageFileInputButton_input__svNx4"}},47180:function(e){e.exports={"compact-only":"only screen and (max-width : 684px)",container:"ChatMessageInputAttachments_container__AAxGu"}},38154:function(e){e.exports={"compact-only":"only screen and (max-width : 684px)",inputContainer:"ChatMessageInputContainer_inputContainer__s2AGa",textArea:"ChatMessageInputContainer_textArea__fNi6E",sendButton:"ChatMessageInputContainer_sendButton__dBjTt",fileInput:"ChatMessageInputContainer_fileInput__9lLAY"}},92002:function(e){e.exports={sendButton:"ChatMessageSendButton_sendButton__4ZyI4",noFreeMessageTooltip:"ChatMessageSendButton_noFreeMessageTooltip__9IhzY"}},47986:function(e){e.exports={button:"ChatMessageVoiceInputButton_button__NjXno",pulse:"ChatMessageVoiceInputButton_pulse__5F2SB",tooltip:"ChatMessageVoiceInputButton_tooltip__oz4tA",fadeInUpAndOut:"ChatMessageVoiceInputButton_fadeInUpAndOut__NP3s1"}},25432:function(e){e.exports={dismissableContainer:"Dismissable_dismissableContainer__4Q5Jv",dismissButton:"Dismissable_dismissButton__faL3Y",icon:"Dismissable_icon__nU8Xb"}},71953:function(e){e.exports={growWrap:"GrowingTextArea_growWrap__im5W3",textArea:"GrowingTextArea_textArea__ZWQbP"}},81791:function(e){e.exports={container:"HorizontallyScrollable_container__biWGT"}},90912:function(e){e.exports={ToastLink:"WebSubscriptionSuccessMessage_ToastLink__eq_NR",ToastTitle:"WebSubscriptionSuccessMessage_ToastTitle__srxYc",ToastText:"WebSubscriptionSuccessMessage_ToastText__08fMf"}}}]);